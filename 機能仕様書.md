# AiNA Works 機能仕様書

## 1. プロジェクト概要

### 1.1 システム名
**AiNA Works** - AIスキルで未来を創るクリエイターマッチングプラットフォーム

### 1.2 目的
AIスクール生と企業をつなぐ、革新的なクリエイティブプラットフォーム。才能と情熱を持つクリエイターが、素晴らしいプロジェクトと出会える場所を提供する。

### 1.3 主要な特徴
- AIスクール生と企業のマッチング
- ポートフォリオ展示機能
- 案件投稿・応募システム
- リアルタイムチャット機能
- 評価・レビューシステム
- 銀行口座管理機能

## 2. システム構成

### 2.1 技術スタック
- **フロントエンド**: HTML5, CSS3, JavaScript (Vanilla), Tailwind CSS
- **バックエンド**: PHP 8.2+
- **データベース**: MySQL/MariaDB 10.4+
- **Webサーバー**: Apache/Nginx
- **外部連携**: AiNA API (認証・ユーザー管理)

### 2.2 ディレクトリ構成
```
aina_works/
├── api/                    # API エンドポイント
├── assets/                 # 静的ファイル (CSS, JS, 画像)
├── config/                 # 設定ファイル
├── includes/               # 共通ライブラリ
├── sql/                    # データベーススキーマ
├── storage/                # アップロードファイル
└── *.php                   # メインページ
```

## 3. ユーザー管理機能

### 3.1 認証システム
- **外部認証**: AiNA API経由での認証
- **セッション管理**: PHPセッションによる状態管理
- **権限管理**: クリエイター/クライアント/管理者の役割分離

#### 3.1.1 ログイン機能
- **ファイル**: `login.php`
- **認証フロー**:
  1. AiNA APIでの認証
  2. ユーザー情報の取得・更新
  3. セッション設定
  4. ダッシュボードへのリダイレクト

#### 3.1.2 ユーザー登録
- **外部管理**: AiNA側でユーザー登録を実施
- **自動同期**: ログイン時にユーザー情報を自動同期

### 3.2 ユーザープロフィール管理
- **ファイル**: `profile.php`
- **機能**:
  - 基本情報の編集
  - プロフィール画像のアップロード
  - スキル設定
  - 銀行口座情報の管理

## 4. 作品管理機能

### 4.1 作品投稿・編集
- **ファイル**: `edit-work.php`
- **機能**:
  - 作品の新規投稿
  - 既存作品の編集
  - 画像アップロード（自動リサイズ・圧縮）
  - カテゴリ分類
  - 価格設定
  - 制作期間の設定

### 4.2 作品一覧・検索
- **ファイル**: `works.php`
- **機能**:
  - カテゴリ別表示
  - キーワード検索
  - フィルタリング
  - ソート機能

### 4.3 作品詳細表示
- **ファイル**: `work-detail.php`
- **機能**:
  - 作品の詳細情報表示
  - クリエイター情報
  - レビュー・評価表示
  - いいね機能
  - 案件依頼機能

## 5. 案件管理機能

### 5.1 案件投稿
- **ファイル**: `post-job.php`
- **機能**:
  - 案件の新規投稿
  - カテゴリ選択
  - 予算設定
  - 納期設定
  - 緊急度設定

### 5.2 案件一覧・検索
- **ファイル**: `jobs.php`
- **機能**:
  - 案件一覧表示
  - カテゴリ別フィルタ
  - 予算範囲フィルタ
  - キーワード検索

### 5.3 案件詳細・応募
- **ファイル**: `job-detail.php`
- **機能**:
  - 案件詳細表示
  - 応募フォーム
  - 提案価格・期間の入力
  - 応募メッセージ

### 5.4 応募管理
- **ファイル**: `job-applications.php`
- **機能**:
  - 応募一覧表示
  - 応募状況の管理
  - 受諾・拒否の処理

## 6. コミュニケーション機能

### 6.1 チャット機能
- **ファイル**: `chat.php`, `chats.php`
- **機能**:
  - リアルタイムチャット
  - メッセージ履歴
  - 未読管理
  - ファイル添付（将来実装予定）

#### 6.1.1 チャットAPI
- **ファイル**: `api/send-chat-message.php`, `api/get-chat-messages.php`
- **機能**:
  - メッセージ送信
  - メッセージ取得
  - 未読カウント管理

### 6.2 メッセージ機能
- **ファイル**: `api/send-message.php`
- **機能**:
  - 個別メッセージ送信
  - 件名付きメッセージ
  - メール通知

## 7. 評価・レビュー機能

### 7.1 レビュー投稿
- **ファイル**: `api/submit-review.php`
- **機能**:
  - 5段階評価
  - コメント投稿
  - 重複投稿防止

### 7.2 いいね機能
- **ファイル**: `api/like.php`
- **機能**:
  - 作品へのいいね
  - いいね数の集計
  - 重複いいね防止

### 7.3 お気に入り機能
- **ファイル**: `api/favorite.php`, `favorites.php`
- **機能**:
  - 作品・クリエイターのお気に入り登録
  - お気に入り一覧表示
  - お気に入り解除

## 8. 決済・口座管理機能

### 8.1 銀行口座管理
- **ファイル**: `api/save-bank-account.php`, `api/get-bank-account.php`
- **機能**:
  - 銀行口座情報の登録・更新
  - 口座情報の取得
  - 主口座の設定

### 8.2 案件依頼機能
- **ファイル**: `api/request-job.php`
- **機能**:
  - クリエイターへの直接依頼
  - プロジェクト詳細の設定
  - 予算・納期の提案

## 9. データベース設計

### 9.1 主要テーブル

#### 9.1.1 ユーザー関連
- **users**: ユーザー基本情報
- **user_roles**: ユーザー役割
- **user_skills**: ユーザースキル
- **user_bank_accounts**: 銀行口座情報

#### 9.1.2 作品関連
- **works**: 作品情報
- **work_likes**: 作品いいね
- **categories**: カテゴリ
- **skills**: スキル

#### 9.1.3 案件関連
- **jobs**: 案件情報
- **job_applications**: 案件応募

#### 9.1.4 コミュニケーション関連
- **chat_rooms**: チャットルーム
- **chat_messages**: チャットメッセージ
- **messages**: 個別メッセージ

#### 9.1.5 評価関連
- **reviews**: レビュー
- **favorites**: お気に入り

### 9.2 データベース関係図
```
users (1) ←→ (N) works
users (1) ←→ (N) jobs
users (1) ←→ (N) job_applications
users (1) ←→ (N) chat_rooms
users (1) ←→ (N) reviews
works (1) ←→ (N) work_likes
works (1) ←→ (N) reviews
categories (1) ←→ (N) works
categories (1) ←→ (N) jobs
```

## 10. API エンドポイント一覧

### 10.1 認証関連
- `POST /login.php` - ログイン処理

### 10.2 作品関連
- `POST /api/like.php` - いいね機能
- `POST /api/submit-review.php` - レビュー投稿

### 10.3 案件関連
- `POST /api/request-job.php` - 案件依頼
- `POST /api/update-application-status.php` - 応募状況更新

### 10.4 コミュニケーション関連
- `POST /api/send-message.php` - メッセージ送信
- `POST /api/send-chat-message.php` - チャットメッセージ送信
- `GET /api/get-chat-messages.php` - チャットメッセージ取得
- `GET /api/get-unread-count.php` - 未読数取得

### 10.5 ユーザー関連
- `POST /api/favorite.php` - お気に入り機能
- `POST /api/save-bank-account.php` - 銀行口座保存
- `GET /api/get-bank-account.php` - 銀行口座取得

## 11. セキュリティ機能

### 11.1 CSRF対策
- 全フォームにCSRFトークンを実装
- `verifyCsrfToken()` 関数による検証

### 11.2 入力値検証
- 全入力値のサニタイズ
- SQLインジェクション対策
- XSS対策

### 11.3 認証・認可
- ログイン必須ページの保護
- 権限に基づくアクセス制御
- セッション管理

## 12. ファイル管理機能

### 12.1 画像アップロード
- **機能**:
  - 自動リサイズ・圧縮
  - ファイル形式検証
  - セキュリティチェック
  - ストレージ管理

### 12.2 ファイル配信
- **ファイル**: `image.php`
- **機能**:
  - セキュアな画像配信
  - キャッシュ制御

## 13. 通知機能

### 13.1 メール通知
- 案件応募時の通知
- メッセージ受信時の通知
- お気に入り追加時の通知

### 13.2 リアルタイム通知
- 未読メッセージ数の表示
- チャット通知

## 14. 管理機能

### 14.1 ダッシュボード
- **ファイル**: `dashboard.php`
- **機能**:
  - ユーザー統計表示
  - 最近の活動表示
  - クイックアクセス

### 14.2 ロール切り替え
- **ファイル**: `switch-role.php`
- **機能**:
  - クリエイター/クライアント役割の切り替え

## 15. 設定・カスタマイズ

### 15.1 環境設定
- **ファイル**: `config/config.php`
- **機能**:
  - データベース接続設定
  - 外部API設定
  - セキュリティ設定

### 15.2 静的ファイル管理
- **ディレクトリ**: `assets/`
- **機能**:
  - CSS/JS ファイル管理
  - 画像アセット管理

## 16. 今後の拡張予定

### 16.1 決済機能
- オンライン決済システムの統合
- 手数料計算機能

### 16.2 高度な検索機能
- AI によるマッチング機能
- 推薦システム

### 16.3 モバイルアプリ
- ネイティブアプリの開発
- プッシュ通知機能

## 17. 運用・保守

### 17.1 ログ管理
- エラーログの記録
- アクセスログの管理
- デバッグ情報の出力

### 17.2 バックアップ
- データベースバックアップ
- ファイルバックアップ
- 復旧手順

### 17.3 パフォーマンス最適化
- データベースクエリの最適化
- キャッシュ機能の実装
- 画像最適化

---

**作成日**: 2025年9月16日  
**バージョン**: 1.0  
**作成者**: AI Assistant
